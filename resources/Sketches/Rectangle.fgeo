<?xml  version="1.0" encoding="UTF-8" ?>
<drgenius>
<drgeo axes="False" grid="True" gridded="True" name="Rectangle" origin_x="-26.974999999999994" origin_y="16.599999999999994" scale="8.0">
<point color="Red" delta="7@7" feedback="True" id="148760077" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free">
<x>-20</x>
<y>0</y></point>
<point color="Red" delta="7@7" feedback="True" id="167809769" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free">
<x>-40</x>
<y>0</y></point>
<point color="Red" delta="7@7" feedback="True" id="242552014" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free">
<x>-40</x>
<y>15</y></point>
<point color="Red" delta="7@7" feedback="True" id="26412413" locked="False" masked="False" name=" " style="Round" thickness="Dashed" type="Free">
<x>-15</x>
<y>15</y></point>
<polygon anchor="0.017" arrow="none" color="Red" delta="-50.57626844760102@10.661000297548908" feedback="True" filled="True" id="64745589" masked="False" name="" style="plain" thickness="small" translucent="True" type="npts">
<parent ref="148760077"/> 
<parent ref="167809769"/> 
<parent ref="242552014"/> 
<parent ref="26412413"/> </polygon>
<value background="Green" border="Transparent" class="DrGeoScriptRectangle" color="Black" delta="7@7" feedback="True" fontSize="14" id="192753662" locked="False" masked="False" name="" type="script">
<parent ref="64745589"/> 
<code>!classDefinition: #DrGeoScriptRectangle category: 'DrGeoII-User'!&#10;DrGeoUserScript subclass: #DrGeoScriptRectangle&#10;&#9;instanceVariableNames: ''&#10;&#9;classVariableNames: ''&#10;&#9;poolDictionaries: ''&#10;&#9;category: 'DrGeoII-User'!&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'drgeo 9/10/2022 13:56:38'!&#10;compute&#10;&#9;self paintRed.&#10;&#9;^ self isRectangle &#10;&#9;&#9;ifTrue: [ &#10;&#9;&#9;&#9;self paintBlue.&#10;&#9;&#9;&#9;'Bravo !! Je suis un rectangle.' ]&#10;&#9;&#9;ifFalse: [  | message |&#10;&#9;&#9;&#9;message _ ReadWriteStream on: String new.&#10;&#9;&#9;&#9;message nextPutAll: 'Voyons, je ne suis pas un rectangle car :'.&#10;&#9;&#9;&#9;self isQuad &#10;&#9;&#9;&#9;&#9;ifFalse: [ message newLine nextPutAll: '- je n''ai pas 4 sommets']&#10;&#9;&#9;&#9;&#9;ifTrue: [ &#10;&#9;&#9;&#9;&#9;&#9;self isOppositeSideIsometric ifFalse: [message newLine nextPutAll: '- mes côtés opposés ne sont pas isométriques'].&#10;&#9;&#9;&#9;&#9;&#9;self isOppositeSideParallel ifFalse: [ message newLine nextPutAll: '- mes côttés opposés ne sont pas parallèles' ].&#10;&#9;&#9;&#9;&#9;&#9;self isRectangleAngle ifFalse: [message newLine nextPutAll: '- mes sommets ne sont pas droits']].&#10;&#9;&#9;&#9;&#9;message contents]! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:05'!&#10;isOppositeSideIsometric&#10;&#9;| side1 side2 side0 side4 points|&#10;&#9;points _ self arg1 points.&#10;&#9;side1 _ points first - points second.&#10;&#9;side2 _ points second - points third.&#10;&#9;side0 _ points third - points fourth.&#10;&#9;side4 _ points fourth - points first.&#10;&#10;&#9;^ side1 r = side0 r and: [side2 r = side4 r]  &#10;! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:06'!&#10;isOppositeSideParallel&#10;&#9;| side1 side2 side0 side4 points|&#10;&#9;points _ self arg1 points.&#10;&#9;side1 _ points first - points second.&#10;&#9;side2 _ points second - points third.&#10;&#9;side0 _ points third - points fourth.&#10;&#9;side4 _ points fourth - points first.&#10;&#10;&#9;^ ((side1 crossProduct: side0) closeTo: 0)  and: [(side2 crossProduct: side4) closeTo: 0]  &#10;! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:17'!&#10;isQuad&#10;&#9;^ self arg1 points size = 4! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:47'!&#10;isRectangle&#10;&#9;| diag1 diag2 points mid1 mid2|&#10;&#9;&#9;points _ self arg1 points.&#10;&#9;diag1 _ points first - points third.&#10;&#9;mid1 _ points first + points third / 2.&#10;&#9;diag2 _ points second - points fourth.&#10;&#9;mid2 _ points second + points fourth / 2.&#10;&#9;^ self isQuad and: [diag1 r = diag2 r and: [mid1 = mid2]]&#10;! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:09'!&#10;isRectangleAngle&#10;&#9;| summits sides |&#10;&#9;summits _ self arg1 points.&#10;&#9;sides _ summits withIndexCollect: [:p :i | p - (summits at: i + 1 ifAbsent: [summits first])].&#10;&#9;sides withIndexDo: [ :s :i |&#10;&#9;&#9;((s dotProduct: (sides at: i + 1 ifAbsent: [sides first])) closeTo: 0) &#10;&#9;&#9;&#9;ifFalse: [ ^ false]].&#10;&#9;^ true! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:00'!&#10;paintBlue&#10;&#9;self costume1 style color: Color blue! !&#10;&#10;!DrGeoScriptRectangle methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:00'!&#10;paintRed&#10;&#9;self costume1 style color: Color red! !&#10;&#10;&quot;-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- &quot;!&#10;&#10;!classDefinition: 'DrGeoScriptRectangle class' category: 'DrGeoII-User'!&#10;DrGeoScriptRectangle class&#10;&#9;instanceVariableNames: ''!&#10;&#10;!DrGeoScriptRectangle class methodsFor: 'public' stamp: 'DrGeoUser 5/22/2015 21:22'!&#10;description&#10;&#9;^'Je vÃ©rifie si un quadrilatÃ¨re est un rectangle.&#10;Pour m''utiliser :&#10;1. Clique sur un polygone ;&#10;2. Clique quelque part sur le fond de la figure.&#10;Je colorie en bleu le quadrilatÃ¨re lorsque c''est un rectangle, sinon j''indique ce qui ne va pas.'! !&#10;&#10;!DrGeoScriptRectangle class methodsFor: 'public' stamp: 'DrGeoUser 4/29/2015 09:29'!&#10;scriptName&#10;&#9;^'Est rectangle ?'! !&#10;&#10;&#10;!DrGeoScriptRectangle class methodsFor: 'private' stamp: 'DrGeoUser 4/29/2015 09:16'!&#10;newArgumentsType&#10;&#9;^{DrGPolygonItem}! !&#10;</code>
<x>-65.62500000000001</x>
<y>32.507500000000014</y></value></drgeo></drgenius>